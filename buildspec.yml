version: 0.2

phases:
  install:
    commands:
      - echo "Installing dependencies"
      - yum install -y git   # Install Git
      - yum install -y wget  # Install wget to download Maven and JDK if not present
      - echo "Installing OpenJDK 17 from Amazon Corretto..."
      - wget https://corretto.aws/downloads/latest/amazon-corretto-17-x64-linux-jdk.rpm  # Download Amazon Corretto OpenJDK 17
      - yum install -y amazon-corretto-17-x64-linux-jdk.rpm   # Install OpenJDK 17 from RPM
      - echo "Java version:"
      - java -version  # Check Java version
      - echo "Downloading Maven..."
      - wget https://downloads.apache.org/maven/maven-3/3.8.8/binaries/apache-maven-3.8.8-bin.tar.gz  # Corrected Maven download link
      - tar xzf apache-maven-3.8.6-bin.tar.gz -C /opt   # Extract Maven to /opt
      - ln -s /opt/apache-maven-3.8.6 /opt/maven   # Create symlink for easier access
      - export PATH=/opt/maven/bin:$PATH   # Add Maven to PATH
      - mvn -v  # Verify Maven installation
      - git --version  # Verify Git installation

  pre_build:
    commands:
      - echo "Setting up environment"
      - echo "Maven version:"
      - mvn -v  # Verify Maven version before build

  build:
    commands:
      - echo "Building the project"
      - mvn clean package  # Your actual build command
      - echo "Build successful"  # Success message

  post_build:
    commands:
      - echo "Build complete"
      - ls -l target/   # List the files in the target directory to check the output

artifacts:
  files:
    - target/*.jar   # Include JAR files in the artifacts
